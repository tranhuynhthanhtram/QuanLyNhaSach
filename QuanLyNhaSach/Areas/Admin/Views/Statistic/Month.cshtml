@{
    ViewBag.Title = "Month";
    Layout = "~/Areas/Admin/Views/Shared/LayoutAdmin.cshtml";
}

<h2>Month</h2>
<div class="row">
    <div class="col-md-12">
        <select id="ddMonth" class="form-control" style="width: 150px">
            <option value="0">Chọn tháng</option>
            <option value="1">Tháng 1</option>
            <option value="2">Tháng 2</option>
            <option value="3">Tháng 3</option>
            <option value="4">Tháng 4</option>
            <option value="5">Tháng 5</option>
            <option value="6">Tháng 6</option>
            <option value="7">Tháng 7</option>
            <option value="8">Tháng 8</option>
            <option value="9">Tháng 9</option>
            <option value="10">Tháng 10</option>
            <option value="11">Tháng 11</option>
            <option value="12">Tháng 12</option>
        </select>
        <div id="dvChart">
            <canvas id="chartProduct"></canvas>
        </div>
    </div>
</div>

@section scripts{
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.6.0/Chart.min.js"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">

    <script>
        $('#ddMonth').on('change', function () {
            var month = $(this).val();
            GetReportList(month);
        });

        var dt = new Date();
        GetReportList(dt.getMonth()+1);

        function GetReportList(month) {
            $.get('/Statistic/GetReportBestSalesByMonth?month=' + month, function (resp) {
                RegisterCharProduct(resp);
            });
        }

        function RegisterCharProduct(lsData) {
            $("canvas#chartProduct").remove();
            $('#dvChart').html('<canvas id="chartProduct"></canvas>');

            var lsLabel = [];
            var lsDataSource = [];

            $.each(lsData, function (index, item) {
                lsLabel.push(item.TenSach);
                lsDataSource.push(item.SoLuongDaBan);
            });
            console.log(lsLabel);
            console.log(lsDataSource);

            var ctx = document.getElementById("chartProduct");

            var barChartData = {
                labels: lsLabel,
                datasets: [
                    {
                        backgroundColor: '#0b9663',
                        borderWidth: 1,
                        data: lsDataSource
                    }
                ]
            };
            var myBarChart = new Chart(ctx, {
                type: 'bar',
                data: barChartData,
            });
        }
    </script>
}
